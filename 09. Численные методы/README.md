# 9. Численные методы

### Цели проекта

- Необходимо построить модель для определения стоимости автомобилей на основании технических характеристик, комплектаций.  
- Метрики оптимизации:  

 * качество предсказания  
 * скорость предсказания  
 * время обучения  

### Задачи проекта

- Загрузить данные
- Изучить данные. Заполнить пропущенные значения и обработать аномалии в столбцах.
- Подготовить выборки для обучения моделей.
- Обучить разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели попробовать разные гиперпараметры.
- Проанализировать время обучения, время предсказания и качество моделей.
- Опираясь на критерии заказчика, выбрать лучшую модель, проверить её качество на тестовой выборке.
- Сделать выводы.

### Итоги

* Получили в своем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей
* Загрузили и подготовьте данные:
 * Обработали пропуски и аномалии.
 * В результате обработки данных осталось 80% строк
* Написали функцию разделения данных на обучающую и тестовую выборки в отношении 3:1 c преобразованием категориальных признаков и масштабированием данных
* Разделили данные на обучающую и тестовую выборки.
* Написали функцию подбора гиперпераметров для модели методом GridSearch с кросс-валидацией (cv=5) по обучающей выборке и фиксацией времени обучения и предсказания.
* Создали модели DecisionTreeRegressor,  RandomForestRegressor, CatBoostRegressor, LighGBMRegressor и константную модель со средним предсказанием, подобрали лучшие параметры, обучили и получим предсказания с расчетом RMSE и временем этих операций:
 * Модель DecisionTreeRegressor:
   * Время обучения: 13.024
   * Время предсказания: 0.01
   * RMSE: 2030.0
 * Модель RandomForestRegressor:
   * Время обучения: 2565.514
   * Время предсказания: 0.742
   * RMSE: 1605.0
 * Модель CatBoostRegressor:
   * Время обучения: 132.693
   * Время предсказания: 0.026
   * RMSE: 1645.0
 * Модель LightGBMRegressor:
   * Время обучения: 87.422
   * Время предсказания: 0.508
   * RMSE: 1660.0
 * Константная модель:
   * Время обучения: 16.447
   * Время предсказания: 0.001
   * RMSE: 4635.0
* По качеству моделей лучшими оказались: 
 * Модель RandomForestRegressor
 * Модель CatBoostRegressor
 * Модель LightGBMRegressor

* при этом Модель RandomForestRegressor имеет огромное время обучения.  Модель CatBoostRegressor и Модель LightGBMRegressor в десятки раз быстрее.
* Худшая модель по качеству — это Модель DecisionTreeRegressor, если не брать во внимание константную модель конечно. Но она и самая быстрая.
* Если учитывать и качество модели, и скорость предсказания, то абсолютным фаворитом будут модели градиентного бустинга.
* Предсказание по сравнению с обучением проходит практически моментально.
* __Для сервиса «Не бит, не крашен» рекомендуем использовать модели CatBoostRegressor или LightGBMRegressor__

### Используемый стек инструментов

- python
- pandas
- numpy
- sklearn
- lightgbm
- matplotlib
- seaborn
- timeit
- warnings
- catboost