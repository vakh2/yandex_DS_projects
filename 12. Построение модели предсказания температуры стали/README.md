# 12. Построение модели предсказания температуры стали

### Цели проекта  

Построить модель, которая будет предсказывать температуру стали (MAE ≤6.0)

### Задачи проекта  

1. Предобработка данных (удаление аномалий, заполнение пропусков, генерация новых признаков, агрегирование по ключу).
2. Объединение в один датафрейм.
3. Исследование объединённого датафрейма, предобработка (с учётом используемых моделей).
4. Разделение на выборки.
5. Масштабирование (при необходимости).
6. МО: подбор гиперпараметров, получение метрики на кросс-валидации, выбор лучшей модели.
7. Проверка качества лучшей модели на тестовой выборке.

### Итоги

* Провели исследование и предобработку.
* Написали функцию разделения данных на обучающую и тестовую выборки в отношении 3:1
* Разделили данные на обучающую и тестовую выборки.
* Написали функцию подбора гиперпераметров для модели методом GridSearch с кросс-валидацией (cv=5) по обучающей выборке и фиксацией времени обучения и предсказания.
* Создали модели DecisionTreeRegressor,  RandomForestRegressor, CatBoostRegressor, LighGBMRegressor и константную модель со медианным предсказанием, подобрали лучшие параметры, обучили и получим предсказания на обучающей выборке с расчетом MAE с кросс-валидацией (cv=5) и временем этих операций:
* Результаты собрали в сводной таблице
* Модели RandomForestRegressor, LighGBMRegressor показали на обучающей выборке с кросс-валидацией примерно одинаковое MAE около 6, но Модель Модель CatBoostRegressor оказалась слаба по скорости обучения но на первом месте по качеству метрики МАЕ = 5.91, поэтому для финального тестирования выбираем предобученную CatBoostRegressor модель.
**Вывод:** МАЕ на тестовой выборке: 5.67 соответствует критерию выполнения проекта.
* После обучения выбранной модели CatBoostRegressor без неинформативных для модели признаков МАЕ на обучающей выборке незначительно снизилось с 5.91 до 5.85 и при этом незначительно снизилось и МАЕ с 5.67 до 5.66 на тестовой выборке.
* В связи с тем, что метрика МАЕ изменилась незначительно:
 * __можно порекомендовать заказчику модель без неинформативных признаков в том случае, если параметры технологического процесса меняться не будут__
 * __а если же возможны какие-либо изменения в количестве или частоте применения редкоиспользуемых материалов, то стоит подумать об использовании модели обученной на всех признаках, как более универсальной.__

### Используемый стек инструментов

- python
- pandas
- numpy
- sklearn
- matplotlib
- seaborn
- catboost 
- lightgbm
- warnings
- scipy
- datetime